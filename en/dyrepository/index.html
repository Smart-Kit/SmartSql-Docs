<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Dynamic Agent Repository | SmartSql</title>
    <meta name="generator" content="VuePress 1.6.0">
    <link rel="icon" href="/logo.png">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="description" content="High performance, high productivity, ultra lightweight ORM. SmartSql = MyBatis + Cache(Memory | Redis) + R/W Splitting +Dynamic Repository + Diagnostics">
    <meta name="keywords" content="SmartSql, MyBatis ,Cache(Memory | Redis) ,ZooKeeper , R/W Splitting , Dynamic Repository,ORM,DotNet,.Net,dotnet core">
    <link rel="preload" href="/assets/css/0.styles.2272f8e8.css" as="style"><link rel="preload" href="/assets/js/app.b764d23b.js" as="script"><link rel="preload" href="/assets/js/2.f0de6cf5.js" as="script"><link rel="preload" href="/assets/js/26.58464561.js" as="script"><link rel="prefetch" href="/assets/js/10.d23fef41.js"><link rel="prefetch" href="/assets/js/11.3173be70.js"><link rel="prefetch" href="/assets/js/12.00fd90ec.js"><link rel="prefetch" href="/assets/js/13.3c8cdac2.js"><link rel="prefetch" href="/assets/js/14.29f7b193.js"><link rel="prefetch" href="/assets/js/15.41fb704e.js"><link rel="prefetch" href="/assets/js/16.054c6069.js"><link rel="prefetch" href="/assets/js/17.278debea.js"><link rel="prefetch" href="/assets/js/18.69165377.js"><link rel="prefetch" href="/assets/js/19.661a7ba4.js"><link rel="prefetch" href="/assets/js/20.b4579faa.js"><link rel="prefetch" href="/assets/js/21.171ad768.js"><link rel="prefetch" href="/assets/js/22.78eb6e8e.js"><link rel="prefetch" href="/assets/js/23.8edbdee3.js"><link rel="prefetch" href="/assets/js/24.06f1433e.js"><link rel="prefetch" href="/assets/js/25.dbd8c249.js"><link rel="prefetch" href="/assets/js/27.4a33ea03.js"><link rel="prefetch" href="/assets/js/28.02a6c185.js"><link rel="prefetch" href="/assets/js/29.b9d070ca.js"><link rel="prefetch" href="/assets/js/3.da7287ed.js"><link rel="prefetch" href="/assets/js/30.1cff4cee.js"><link rel="prefetch" href="/assets/js/31.6e505c47.js"><link rel="prefetch" href="/assets/js/32.64930bed.js"><link rel="prefetch" href="/assets/js/33.a3bff542.js"><link rel="prefetch" href="/assets/js/34.2ccd7fce.js"><link rel="prefetch" href="/assets/js/35.683f41dd.js"><link rel="prefetch" href="/assets/js/36.a7b51a3f.js"><link rel="prefetch" href="/assets/js/37.29ea3196.js"><link rel="prefetch" href="/assets/js/38.b2009c72.js"><link rel="prefetch" href="/assets/js/39.67b47111.js"><link rel="prefetch" href="/assets/js/4.03454347.js"><link rel="prefetch" href="/assets/js/40.08c3b24c.js"><link rel="prefetch" href="/assets/js/41.96c311cf.js"><link rel="prefetch" href="/assets/js/42.9a5fa5fd.js"><link rel="prefetch" href="/assets/js/43.38ceb0af.js"><link rel="prefetch" href="/assets/js/44.5bf1c228.js"><link rel="prefetch" href="/assets/js/45.7e5d0694.js"><link rel="prefetch" href="/assets/js/46.dbff50bb.js"><link rel="prefetch" href="/assets/js/47.e39d468e.js"><link rel="prefetch" href="/assets/js/48.eef30ad8.js"><link rel="prefetch" href="/assets/js/49.299b8748.js"><link rel="prefetch" href="/assets/js/5.3f3b5b73.js"><link rel="prefetch" href="/assets/js/6.b5cdff4e.js"><link rel="prefetch" href="/assets/js/7.e6032164.js"><link rel="prefetch" href="/assets/js/8.06d8af1f.js"><link rel="prefetch" href="/assets/js/9.a2894045.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2272f8e8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/en/" class="home-link router-link-active"><!----> <span class="site-name">SmartSql</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/en/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/en/config/" class="nav-link">
  Config Reference
</a></div><div class="nav-item"><a href="/en/dyrepository/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Dynamic Repository
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="FAQ" class="dropdown-title"><span class="title">FAQ</span> <span class="arrow down"></span></button> <button type="button" aria-label="FAQ" class="mobile-dropdown-title"><span class="title">FAQ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/en/faq/" class="nav-link">
  Common Problems
</a></li><li class="dropdown-item"><!----> <a href="/en/faq/performance-test/" class="nav-link">
  Performance evaluation
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/dotnetcore/SmartSql/releases" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Update history
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/Smart-Kit/SmartCode" target="_blank" rel="noopener noreferrer" class="nav-link external">
  SmartCode
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dyrepository/" class="nav-link">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/en/dyrepository/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li></ul></div></div> <a href="https://github.com/Smart-Kit/SmartSql" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/en/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/en/config/" class="nav-link">
  Config Reference
</a></div><div class="nav-item"><a href="/en/dyrepository/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Dynamic Repository
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="FAQ" class="dropdown-title"><span class="title">FAQ</span> <span class="arrow down"></span></button> <button type="button" aria-label="FAQ" class="mobile-dropdown-title"><span class="title">FAQ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/en/faq/" class="nav-link">
  Common Problems
</a></li><li class="dropdown-item"><!----> <a href="/en/faq/performance-test/" class="nav-link">
  Performance evaluation
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/dotnetcore/SmartSql/releases" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Update history
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/Smart-Kit/SmartCode" target="_blank" rel="noopener noreferrer" class="nav-link external">
  SmartCode
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dyrepository/" class="nav-link">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/en/dyrepository/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li></ul></div></div> <a href="https://github.com/Smart-Kit/SmartSql" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/en/dyrepository/" aria-current="page" class="active sidebar-link">Dynamic Agent Repository</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/en/dyrepository/#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/en/dyrepository/#suitable-for-scenarios" class="sidebar-link">Suitable for scenarios</a></li><li class="sidebar-sub-header"><a href="/en/dyrepository/#introduction-to-use" class="sidebar-link">Introduction to use</a></li><li class="sidebar-sub-header"><a href="/en/dyrepository/#summarize" class="sidebar-link">Summarize</a></li></ul></li><li><a href="/en/dyrepository/options.html" class="sidebar-link">DyRepository Configuration</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="dynamic-agent-repository"><a href="#dynamic-agent-repository" class="header-anchor">#</a> Dynamic Agent Repository</h1> <h2 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h2> <p>Dynamic Agent Repository (SmartSql.DyRepository) components are SmartSql very unique features that simplify the use of SmartSql. There is little intrusion into the business code other than configuration. It can be said that using ISqlMapper is the original method, and DyRepository automatically helps you implement these methods.</p> <p>DyRepository only need to define the Repository interface, through a simple configuration can automatically implement these interfaces and register in the IoC container, when used injection instant acquisition implementation. The principle is to obtain the Scope and SqlId in the XML file of SmartSql through the naming rules of the interface and interface method, use the parameters of the interface method as the Request, and automatically judge the query or perform the operation through the SQL in the XML, and finally realize the ISqlMapper Call.</p> <h2 id="suitable-for-scenarios"><a href="#suitable-for-scenarios" class="header-anchor">#</a> Suitable for scenarios</h2> <ol><li>Architecture using Repository mode</li></ol> <p>The Repository model is mainly used in DDD tactics and is used to isolate fields and databases. The functional requirements of DyRepository are mainly found in the practice of DDD, which has so far met most of the needs of DDD practice, and if there are other relevant needs welcome to put forward Issue.</p> <ol start="2"><li>Applications similar to SqlHepler</li></ol> <p>DyRepository can implement any one of the interfaces to query the database tool, CURD method is not the exception. The decoupling effect can be played more through interface injection.</p> <h2 id="introduction-to-use"><a href="#introduction-to-use" class="header-anchor">#</a> Introduction to use</h2> <p>The following is a brief demonstration of the comparison between the use of DyRepository and ISqlMapper.</p> <h3 id="ready-to-work"><a href="#ready-to-work" class="header-anchor">#</a> Ready to work</h3> <ol><li>First to create a Repository, this warehousing does not rely on SmartSql, just ordinary warehousing interface</li></ol> <div class="language-csharp extra-class"><pre class="language-csharp"><code>    <span class="token comment">//Repository interface, the default template is I{Scope}Repository, so the Scope of this interface is Activity</span>
    <span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IActivityRepository</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//The interface method corresponds to SqlId, so the SqlId of this method is Insert</span>
        <span class="token comment">//The method parameter corresponds to Request, so the Request of this method is activity</span>
        <span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">Insert</span><span class="token punctuation">(</span><span class="token class-name">Activity</span> activity<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//The parameters of the value type are automatically encapsulated as an object, so the Request of this method is new {activityId = activityId}</span>
        <span class="token return-type class-name">Activity</span> <span class="token function">Query</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">long</span></span> activityId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>Create a configuration XML file SmartSqlMapConfig.xml：</li></ol> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SmartSqlMapConfig</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://SmartSql.net/schemas/SmartSqlMapConfig.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Settings</span> <span class="token attr-name">IsWatchConfigFile</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token attr-name">IgnoreParameterCase</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Database</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--ParameterPrefix:[SqlServer:@ | MySQL:? |Oracle::] --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DbProvider</span> <span class="token attr-name">Name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>SqlServer<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Write</span> <span class="token attr-name">Name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>WriteDB<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ConnectionString</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Data Source=.;Initial Catalog=SmartSqlStarterDB;Integrated Security=True<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Database</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SmartSqlMaps</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SmartSqlMap</span> <span class="token attr-name">Path</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Maps<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Directory<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SmartSqlMap</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SmartSqlMaps</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SmartSqlMapConfig</span><span class="token punctuation">&gt;</span></span>

</code></pre></div><ol start="3"><li>Then create the XML configuration file Activity.xml, put it in the Maps directory, and set it to always copy in the properties panel:</li></ol> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SmartSqlMap</span> <span class="token attr-name">Scope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Activity<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://SmartSql.net/schemas/SmartSqlMap.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Statements</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Statement</span> <span class="token attr-name">Id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Insert<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      INSERT INTO Activity
      (ActivityId
      ,Name
      ,BeginTime
      ,Address
      ,CreationTime
      ,Deleted)
      VALUES
      (@ActivityId
      ,@Name
      ,@BeginTime
      ,@Address
      ,@CreationTime
      ,@Deleted)
      ;Select Scope_Identity();
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Statement</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Statement</span> <span class="token attr-name">Id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Query<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      SELECT * FROM Activity
      WHERE
      ActivityId = @activityId;
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Statement</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Statements</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SmartSqlMap</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>When the preparation is complete, the following can show the difference between the two uses.</p> <h3 id="two-uses"><a href="#two-uses" class="header-anchor">#</a> Two uses</h3> <h4 id="isqlmapper-usage"><a href="#isqlmapper-usage" class="header-anchor">#</a> ISqlMapper usage</h4> <p>If we don't use DyRepository, we need to use ISqlMapper to achieve this warehousing.</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ActivityRepository</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IActivityRepository</span></span>
    <span class="token punctuation">{</span>
        <span class="token class-name">ISmartSqlMapper</span> SqlMapper <span class="token operator">=</span> MapperContainer<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span><span class="token function">GetSqlMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">Insert</span><span class="token punctuation">(</span><span class="token class-name">Activity</span> activity<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">return</span> SqlMapper<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">ExecuteScalar</span><span class="token generic class-name"><span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">RequestContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                Scope <span class="token operator">=</span> <span class="token string">&quot;Activity&quot;</span><span class="token punctuation">,</span>
                SqlId <span class="token operator">=</span> <span class="token string">&quot;Insert&quot;</span><span class="token punctuation">,</span>
                Request <span class="token operator">=</span> activity
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token return-type class-name">Activity</span> <span class="token function">Query</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">long</span></span> activityId<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">return</span> SqlMapper<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Query</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Activity<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">RequestContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                Scope <span class="token operator">=</span> <span class="token string">&quot;Activity&quot;</span><span class="token punctuation">,</span>
                SqlId <span class="token operator">=</span> <span class="token string">&quot;Query&quot;</span><span class="token punctuation">,</span>
                Request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> activityId <span class="token operator">=</span> activityId <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>And register the implementation class with the IoC.:</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token class-name"><span class="token keyword">var</span></span> services <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ServiceCollection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token return-type class-name"><span class="token keyword">var</span></span> services<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">AddSingleton</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>IActivityRepository<span class="token punctuation">,</span>ActivityRepository<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="dyrepository"><a href="#dyrepository" class="header-anchor">#</a> DyRepository</h4> <p>If you use DyRepository, we only need to configure the IoC registration.</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code>    <span class="token class-name"><span class="token keyword">var</span></span> services <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ServiceCollection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    services<span class="token punctuation">.</span><span class="token function">AddSmartSqlRepositoryFromAssembly</span><span class="token punctuation">(</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    <span class="token punctuation">{</span>
        options<span class="token punctuation">.</span>AssemblyString <span class="token operator">=</span> <span class="token string">&quot;SmartSql.Starter.Repository&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="injection-usage"><a href="#injection-usage" class="header-anchor">#</a> Injection usage</h4> <p>Use the method to inject the interface, and then call the interface method.</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code>    <span class="token comment">// Suppose ActivityService has been registered with the IoC container</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ActivityService</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">IActivityRepository</span> activityRepository<span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token function">ActivityService</span><span class="token punctuation">(</span><span class="token class-name">IActivityRepository</span> activityRepository<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>activityRepository <span class="token operator">=</span> activityRepository<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">Create</span><span class="token punctuation">(</span><span class="token class-name">Activity</span> activity<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">return</span> activityRepository<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span>activity<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">GetById</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> id<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">return</span> activityRepository<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

</code></pre></div><h2 id="summarize"><a href="#summarize" class="header-anchor">#</a> Summarize</h2> <p>Through the simple contrast between DyRepository and ISqlMapper, we can see that DyRepository is powerful and saves us a lot of code. Of course, ISqlMapper naturally has its flexibility and is able to use it anywhere. But if there are no other special needs, in terms of architecture, because there is little intrusion into business code, DyRepository is undoubtedly the most recommended way to use it.</p> <p>This article only describes the use of the DyRepository default convention, in fact, it can also be through a variety of configuration items to achieve more flexible functions. For more information, see the next DyRepository configuration.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/Smart-Kit/SmartSql-Docs/edit/master/docs/en/dyrepository/README.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/28/2019, 3:16:05 PM</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/en/dyrepository/options.html">
        DyRepository Configuration
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.b764d23b.js" defer></script><script src="/assets/js/2.f0de6cf5.js" defer></script><script src="/assets/js/26.58464561.js" defer></script>
  </body>
</html>
